[{"tags":[{"type":"copyright","string":"(c) 2016 able99","html":"<p>(c) 2016 able99</p>"},{"type":"author","string":"able99 (8846755@qq.com)","html":"<p>able99 (8846755@qq.com)</p>"},{"type":"license","string":"MIT","html":"<p>MIT</p>"}],"description":{"full":"<p>bnorth solution</p>","summary":"<p>bnorth solution</p>","body":""},"isPrivate":false,"isConstructor":false,"isClass":false,"isEvent":false,"ignore":false,"line":1,"codeStart":9,"code":"import { timeInit, time, timeFrom } from '../utils/time';\nimport { check, checkObject, checkObjectItem } from '../utils/validator';","ctx":false},{"tags":[{"type":"class","string":"","html":""},{"type":"example","string":"**使用**\napp.format.xxx\n**hook**\n参见Browser hook说明","html":"<p><strong>使用</strong><br />\napp.format.xxx<br />\n<strong>hook</strong><br />\n参见Browser hook说明</p>"}],"description":{"full":"<p>为app 提供格式化输出与数据校验的功能扩展</p>","summary":"<p>为app 提供格式化输出与数据校验的功能扩展</p>","body":""},"isPrivate":false,"isConstructor":false,"isClass":true,"isEvent":false,"ignore":false,"line":13,"codeStart":22,"code":"class Format {\n  constructor(app){\n    this.app = app;\n\n    this.moneyDefault = '0.00';\n\n    this.timeFormat = \"YYYY-MM-DD HH:mm:ss\";\n\n    this.byteSizeG = 'G';\n    this.byteSizeM = 'M';\n    this.byteSizeK = 'K';\n    this.byteSizeB = 'B';\n\n    this.checkErrorMessage = 'error';\n  }\n\n  money(val){\n    return !isNaN(val)?Number(val).toFixed(2):this.moneyDefault;\n  }\n\n  discount(value, discount, min=0.01) {\n    if(isNaN(value)||Number(value)===0) return 0;\n    if(isNaN(discount)) return value;\n\n    return Math.max(Math.round(value*100*discount)/100, min);\n  }\n\n  timeInit() {\n    return timeInit();\n  }\n\n  time(val, options){\n    options = options||{};\n    options.format = options.format || this.timeFormat;\n    return time(val, options);\n  }\n\n  timeFrom(val, options){\n    return timeFrom(val, options);\n  }\n\n  byteSize(size=0, fixed=2){\n    if(size>1024*1024*1024){\n      return (size/1024/1024/1024).toFixed(fixed)+this.byteSizeG;\n    }else if(size>1024*1024){\n      return (size/1024/1024).toFixed(fixed)+this.byteSizeM;\n    }else if(size>1024){\n      return (size/1024).toFixed(fixed)+this.byteSizeK;\n    }else{\n      return (size?size:0)+this.byteSizeB;\n    }\n  }\n\n  check(val, arule, options, errorMessage) {\n    return check(val, arule, options, this.checkErrorMessage);\n  }\n\n  checkObjectItem(obj, key, rules, options)  {\n    return checkObjectItem(obj, key, rules, options);\n  }\n\n  checkObject(obj, rules, options)  {\n    return checkObject(obj, rules, options);\n  }\n}\n\n\nexport default {\n  init(app) {\n    app.Format = Format;\n    app.format = new Format(app);\n  }\n}","ctx":{"type":"class","constructor":"Format","cons":"Format","name":"Format","extends":"","string":"new Format()"}}]